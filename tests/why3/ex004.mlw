module Check
  use import int.Int

  type state = { mutable var1:int; mutable var2:int; mutable n2:int; }

  let step (s: state) (x:bool) : bool =
    let n2 = s.n2 in
    let var2 = s.var2 in
    let var1 = s.var1 in
    let n1 =
    match x with
    | True -> var1 + 1
    | False -> var2
    end in
    s.var1 <- n1;
    s.var2 <- n1;
    s.n2 <- n2 - 1;
    let ok = n1 > n2 in
    ok
end
